local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local LocalPlayer = game:GetService("Players").LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local HttpService = game:GetService("HttpService")
local TextService = game:GetService("TextService")

getgenv().gethui = function() return game.CoreGui end

-- Modern color palette
local NeoColors = {
    Primary = Color3.fromRGB(120, 85, 255),     -- Neon purple
    Secondary = Color3.fromRGB(0, 200, 255),    -- Cyan accent
    Dark = Color3.fromRGB(15, 15, 25),          -- Deep space
    Darker = Color3.fromRGB(10, 10, 20),        -- Space black
    Light = Color3.fromRGB(45, 45, 65),         -- Space gray
    Lighter = Color3.fromRGB(60, 60, 85),       -- Light space
    Text = Color3.fromRGB(245, 245, 255),       -- Off-white
    TextDark = Color3.fromRGB(170, 170, 200),   -- Muted text
    Success = Color3.fromRGB(0, 230, 118),      -- Neon green
    Warning = Color3.fromRGB(255, 145, 0),      -- Orange
    Danger = Color3.fromRGB(255, 60, 100),      -- Pink-red
    Glass = Color3.fromRGB(255, 255, 255, 0.1)  -- Glass effect
}

local OrionLib = {
    Elements = {},
    ThemeObjects = {},
    Connections = {},
    Flags = {},
    Themes = {
        Neon = {
            Main = NeoColors.Dark,
            Second = NeoColors.Darker,
            Stroke = NeoColors.Lighter,
            Divider = NeoColors.Light,
            Text = NeoColors.Text,
            TextDark = NeoColors.TextDark,
            Accent = NeoColors.Primary,
            Accent2 = NeoColors.Secondary,
            Success = NeoColors.Success,
            Warning = NeoColors.Warning,
            Danger = NeoColors.Danger
        }
    },
    SelectedTheme = "Neon",
    Folder = nil,
    SaveCfg = false,
    CurrentWindow = nil
}

-- Enhanced icons with more options
local Icons = {
    Home = "rbxassetid://7072715794",
    Settings = "rbxassetid://7072718282",
    User = "rbxassetid://7072720983",
    Star = "rbxassetid://7072719976",
    Zap = "rbxassetid://7072723629",
    Shield = "rbxassetid://7072717170",
    Gamepad = "rbxassetid://7072716544",
    Code = "rbxassetid://7072714337",
    Eye = "rbxassetid://7072715606",
    Lock = "rbxassetid://7072717978",
    Unlock = "rbxassetid://7072722827",
    Check = "rbxassetid://7072713700",
    X = "rbxassetid://7072725342",
    Menu = "rbxassetid://7072717658",
    Minimize = "rbxassetid://7072719338",
    Maximize = "rbxassetid://7072720870",
    Plus = "rbxassetid://7072720017",
    Minus = "rbxassetid://7072718655",
    ChevronRight = "rbxassetid://7072713932",
    ChevronDown = "rbxassetid://7072713207",
    Palette = "rbxassetid://7072722265",
    Sliders = "rbxassetid://7072719557",
    Terminal = "rbxassetid://7072721713",
    Bell = "rbxassetid://7072712899",
    Bot = "rbxassetid://17615525476"
}

-- Create main container
local Orion = Instance.new("ScreenGui")
Orion.Name = "NeonUI"
Orion.ResetOnSpawn = false
Orion.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

if syn and syn.protect_gui then
    syn.protect_gui(Orion)
    Orion.Parent = game.CoreGui
elseif gethui then
    Orion.Parent = gethui()
else
    Orion.Parent = game:GetService("CoreGui")
end

-- Clean duplicates
if gethui then
    for _, Interface in ipairs(gethui():GetChildren()) do
        if Interface.Name == Orion.Name and Interface ~= Orion then
            Interface:Destroy()
        end
    end
else
    for _, Interface in ipairs(game.CoreGui:GetChildren()) do
        if Interface.Name == Orion.Name and Interface ~= Orion then
            Interface:Destroy()
        end
    end
end

-- Utility functions
function OrionLib:IsRunning()
    return Orion.Parent ~= nil
end

local function AddConnection(Signal, Function)
    if not OrionLib:IsRunning() then return end
    local SignalConnect = Signal:Connect(Function)
    table.insert(OrionLib.Connections, SignalConnect)
    return SignalConnect
end

task.spawn(function()
    while OrionLib:IsRunning() do
        wait()
    end
    for _, Connection in next, OrionLib.Connections do
        Connection:Disconnect()
    end
end)

local function Create(Name, Properties, Children)
    local Object = Instance.new(Name)
    for i, v in next, Properties or {} do
        Object[i] = v
    end
    for i, v in next, Children or {} do
        v.Parent = Object
    end
    return Object
end

local function MakeDraggable(DragPoint, Main)
    pcall(function()
        local Dragging, DragInput, MousePos, FramePos = false
        AddConnection(DragPoint.InputBegan, function(Input)
            if Input.UserInputType == Enum.UserInputType.MouseButton1 or Input.UserInputType == Enum.UserInputType.Touch then
                Dragging = true
                MousePos = Input.Position
                FramePos = Main.Position

                Input.Changed:Connect(function()
                    if Input.UserInputState == Enum.UserInputState.End then
                        Dragging = false
                    end
                end)
            end
        end)
        
        AddConnection(DragPoint.InputChanged, function(Input)
            if Input.UserInputType == Enum.UserInputType.MouseMovement or Input.UserInputType == Enum.UserInputType.Touch then
                DragInput = Input
            end
        end)
        
        AddConnection(UserInputService.InputChanged, function(Input)
            if Input == DragInput and Dragging then
                local Delta = Input.Position - MousePos
                TweenService:Create(Main, TweenInfo.new(0.05, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                    Position = UDim2.new(FramePos.X.Scale, FramePos.X.Offset + Delta.X, FramePos.Y.Scale, FramePos.Y.Offset + Delta.Y)
                }):Play()
            end
        end)
    end)
end

-- Create reusable UI elements with new design
CreateElement = function(ElementName, ElementFunction)
    OrionLib.Elements[ElementName] = function(...)
        return ElementFunction(...)
    end
end

MakeElement = function(ElementName, ...)
    return OrionLib.Elements[ElementName](...)
end

-- Enhanced UI Elements
CreateElement("NeonFrame", function(Color, CornerRadius)
    local Frame = Create("Frame", {
        BackgroundColor3 = Color or NeoColors.Dark,
        BorderSizePixel = 0,
        BackgroundTransparency = 0
    })
    
    if CornerRadius then
        local Corner = Create("UICorner", {
            CornerRadius = UDim.new(0, CornerRadius)
        })
        Corner.Parent = Frame
    end
    
    return Frame
end)

CreateElement("GlassFrame", function()
    local Frame = Create("Frame", {
        BackgroundColor3 = Color3.new(1, 1, 1),
        BorderSizePixel = 0,
        BackgroundTransparency = 0.95
    })
    
    local Stroke = Create("UIStroke", {
        Color = NeoColors.Lighter,
        Thickness = 1,
        Transparency = 0.7
    })
    Stroke.Parent = Frame
    
    local Corner = Create("UICorner", {
        CornerRadius = UDim.new(0, 12)
    })
    Corner.Parent = Frame
    
    return Frame
end)

CreateElement("NeonButton", function()
    local Button = Create("TextButton", {
        Text = "",
        AutoButtonColor = false,
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        Size = UDim2.new(1, 0, 1, 0)
    })
    return Button
end)

CreateElement("NeonLabel", function(Text, Size, IsTitle)
    local Label = Create("TextLabel", {
        Text = Text or "",
        TextColor3 = NeoColors.Text,
        TextTransparency = 0,
        TextSize = Size or (IsTitle and 18 or 14),
        Font = IsTitle and Enum.Font.GothamBlack or Enum.Font.GothamSemibold,
        RichText = true,
        BackgroundTransparency = 1,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextYAlignment = Enum.TextYAlignment.Center
    })
    return Label
end)

CreateElement("Icon", function(IconName, Size, Color)
    local Image = Create("ImageLabel", {
        Image = Icons[IconName] or IconName,
        ImageColor3 = Color or NeoColors.Text,
        ImageTransparency = 0,
        BackgroundTransparency = 1,
        Size = UDim2.new(0, Size or 20, 0, Size or 20),
        ScaleType = Enum.ScaleType.Fit
    })
    return Image
end)

CreateElement("GradientStroke", function(Color1, Color2, Thickness)
    local Stroke = Create("UIStroke", {
        Thickness = Thickness or 2,
        Transparency = 0.3
    })
    
    local Gradient = Create("UIGradient", {
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color1 or NeoColors.Primary),
            ColorSequenceKeypoint.new(0.5, Color2 or NeoColors.Secondary),
            ColorSequenceKeypoint.new(1, Color1 or NeoColors.Primary)
        }),
        Rotation = 45
    })
    Gradient.Parent = Stroke
    
    return Stroke
end)

-- Notification system with new design
local NotificationHolder = Create("Frame", {
    Name = "NotificationHolder",
    Parent = Orion,
    Position = UDim2.new(1, -20, 1, -20),
    Size = UDim2.new(0, 350, 1, -40),
    AnchorPoint = Vector2.new(1, 1),
    BackgroundTransparency = 1
}, {
    Create("UIListLayout", {
        HorizontalAlignment = Enum.HorizontalAlignment.Right,
        SortOrder = Enum.SortOrder.LayoutOrder,
        VerticalAlignment = Enum.VerticalAlignment.Bottom,
        Padding = UDim.new(0, 10)
    })
})

function OrionLib:MakeNotification(NotificationConfig)
    spawn(function()
        NotificationConfig.Name = NotificationConfig.Name or "Notification"
        NotificationConfig.Content = NotificationConfig.Content or "Test notification"
        NotificationConfig.Icon = NotificationConfig.Icon or Icons.Bell
        NotificationConfig.Time = NotificationConfig.Time or 5
        NotificationConfig.Color = NotificationConfig.Color or NeoColors.Primary

        local Notification = Create("Frame", {
            Name = "Notification",
            Parent = NotificationHolder,
            Size = UDim2.new(1, 0, 0, 0),
            BackgroundTransparency = 1,
            AutomaticSize = Enum.AutomaticSize.Y,
            LayoutOrder = 999999
        })

        local MainFrame = Create("Frame", {
            Name = "MainFrame",
            Parent = Notification,
            Size = UDim2.new(1, -10, 0, 0),
            Position = UDim2.new(1, 50, 0, 0),
            BackgroundColor3 = NeoColors.Darker,
            AutomaticSize = Enum.AutomaticSize.Y,
            ClipsDescendants = true
        }, {
            Create("UICorner", {CornerRadius = UDim.new(0, 12)}),
            Create("UIStroke", {
                Color = NotificationConfig.Color,
                Thickness = 2,
                Transparency = 0.3
            }),
            Create("UIPadding", {
                PaddingTop = UDim.new(0, 15),
                PaddingBottom = UDim.new(0, 15),
                PaddingLeft = UDim.new(0, 15),
                PaddingRight = UDim.new(0, 15)
            }),
            Create("UIListLayout", {
                SortOrder = Enum.SortOrder.LayoutOrder,
                Padding = UDim.new(0, 10)
            })
        })

        -- Header
        local Header = Create("Frame", {
            Name = "Header",
            Parent = MainFrame,
            Size = UDim2.new(1, 0, 0, 24),
            BackgroundTransparency = 1
        }, {
            Create("UIListLayout", {
                SortOrder = Enum.SortOrder.LayoutOrder,
                FillDirection = Enum.FillDirection.Horizontal,
                Padding = UDim.new(0, 10)
            })
        })

        Create("ImageLabel", {
            Name = "Icon",
            Parent = Header,
            Size = UDim2.new(0, 20, 0, 20),
            Image = NotificationConfig.Icon,
            ImageColor3 = NotificationConfig.Color,
            BackgroundTransparency = 1
        })

        Create("TextLabel", {
            Name = "Title",
            Parent = Header,
            Size = UDim2.new(1, -30, 1, 0),
            Text = NotificationConfig.Name,
            TextColor3 = NeoColors.Text,
            TextSize = 16,
            Font = Enum.Font.GothamBold,
            TextXAlignment = Enum.TextXAlignment.Left,
            BackgroundTransparency = 1
        })

        -- Content
        Create("TextLabel", {
            Name = "Content",
            Parent = MainFrame,
            Size = UDim2.new(1, 0, 0, 0),
            Text = NotificationConfig.Content,
            TextColor3 = NeoColors.TextDark,
            TextSize = 14,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextWrapped = true,
            BackgroundTransparency = 1,
            AutomaticSize = Enum.AutomaticSize.Y
        })

        -- Animate in
        TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
            Position = UDim2.new(0, 0, 0, 0)
        }):Play()

        -- Wait and animate out
        wait(NotificationConfig.Time)
        
        TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
            Position = UDim2.new(1, 50, 0, 0),
            BackgroundTransparency = 1
        }):Play()
        
        TweenService:Create(MainFrame.UIStroke, TweenInfo.new(0.5, Enum.EasingStyle.Quad), {
            Transparency = 1
        }):Play()

        wait(0.5)
        Notification:Destroy()
    end)
end

function OrionLib:Init()
    if OrionLib.SaveCfg then
        pcall(function()
            if isfile and OrionLib.Folder and isfile(OrionLib.Folder .. "/" .. game.GameId .. ".txt") then
                LoadCfg(readfile(OrionLib.Folder .. "/" .. game.GameId .. ".txt"))
                OrionLib:MakeNotification({
                    Name = "Configuration",
                    Content = "Auto-loaded configuration for " .. game.GameId,
                    Color = NeoColors.Success
                })
            end
        end)
    end
end

-- Main Window Creation
function OrionLib:MakeWindow(WindowConfig)
    local FirstTab = true
    local Minimized = false
    local Loaded = false
    local UIHidden = false

    WindowConfig = WindowConfig or {}
    WindowConfig.Name = WindowConfig.Name or "Neon UI"
    WindowConfig.ConfigFolder = WindowConfig.ConfigFolder or "NeonUI_Configs"
    WindowConfig.SaveConfig = WindowConfig.SaveConfig or false
    WindowConfig.HidePremium = WindowConfig.HidePremium or false
    WindowConfig.IntroEnabled = WindowConfig.IntroEnabled or true
    WindowConfig.IntroText = WindowConfig.IntroText or "Neon UI"
    WindowConfig.ShowIcon = WindowConfig.ShowIcon or true
    WindowConfig.Icon = WindowConfig.Icon or Icons.Bot
    WindowConfig.IntroIcon = WindowConfig.IntroIcon or Icons.Bot
    WindowConfig.AccentColor = WindowConfig.AccentColor or NeoColors.Primary
    WindowConfig.Size = WindowConfig.Size or UDim2.new(0, 650, 0, 450)

    OrionLib.Folder = WindowConfig.ConfigFolder
    OrionLib.SaveCfg = WindowConfig.SaveConfig
    OrionLib.CurrentWindow = WindowConfig

    if WindowConfig.SaveConfig and makefolder and isfolder then
        if not isfolder(WindowConfig.ConfigFolder) then
            makefolder(WindowConfig.ConfigFolder)
        end
    end

    -- Create main window container
    local MainContainer = Create("Frame", {
        Name = "MainContainer",
        Parent = Orion,
        Position = UDim2.new(0.5, -325, 0.5, -225),
        Size = WindowConfig.Size,
        BackgroundColor3 = Color3.fromRGB(0, 0, 0),
        BackgroundTransparency = 0.3,
        Active = true,
        ClipsDescendants = true
    }, {
        Create("UICorner", {CornerRadius = UDim.new(0, 20)}),
        Create("UIStroke", {
            Color = WindowConfig.AccentColor,
            Thickness = 2,
            Transparency = 0.5
        })
    })

    -- Background gradient
    local BackgroundGradient = Create("UIGradient", {
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, NeoColors.Dark),
            ColorSequenceKeypoint.new(0.5, NeoColors.Darker),
            ColorSequenceKeypoint.new(1, NeoColors.Dark)
        }),
        Rotation = 45
    })
    BackgroundGradient.Parent = MainContainer

    -- Title bar
    local TitleBar = Create("Frame", {
        Name = "TitleBar",
        Parent = MainContainer,
        Size = UDim2.new(1, 0, 0, 45),
        BackgroundColor3 = NeoColors.Darker,
        BackgroundTransparency = 0.2
    }, {
        Create("UICorner", {
            CornerRadius = UDim.new(0, 20),
            CornerMask = Enum.CornerMask.TopLeft + Enum.CornerMask.TopRight
        }),
        Create("UIStroke", {
            Color = WindowConfig.AccentColor,
            Thickness = 1,
            Transparency = 0.3
        })
    })

    -- Title
    local TitleContainer = Create("Frame", {
        Name = "TitleContainer",
        Parent = TitleBar,
        Size = UDim2.new(1, -120, 1, 0),
        BackgroundTransparency = 1
    }, {
        Create("UIListLayout", {
            SortOrder = Enum.SortOrder.LayoutOrder,
            FillDirection = Enum.FillDirection.Horizontal,
            Padding = UDim.new(0, 10)
        }),
        Create("UIPadding", {
            PaddingLeft = UDim.new(0, 20),
            PaddingRight = UDim.new(0, 20)
        })
    })

    if WindowConfig.ShowIcon then
        Create("ImageLabel", {
            Name = "WindowIcon",
            Parent = TitleContainer,
            Size = UDim2.new(0, 24, 0, 24),
            Image = WindowConfig.Icon,
            ImageColor3 = WindowConfig.AccentColor,
            BackgroundTransparency = 1
        })
    end

    Create("TextLabel", {
        Name = "WindowTitle",
        Parent = TitleContainer,
        Size = UDim2.new(1, -40, 1, 0),
        Text = WindowConfig.Name,
        TextColor3 = NeoColors.Text,
        TextSize = 20,
        Font = Enum.Font.GothamBlack,
        TextXAlignment = Enum.TextXAlignment.Left,
        BackgroundTransparency = 1
    })

    -- Control buttons
    local ControlButtons = Create("Frame", {
        Name = "ControlButtons",
        Parent = TitleBar,
        Size = UDim2.new(0, 80, 1, 0),
        Position = UDim2.new(1, -80, 0, 0),
        BackgroundTransparency = 1
    }, {
        Create("UIListLayout", {
            SortOrder = Enum.SortOrder.LayoutOrder,
            FillDirection = Enum.FillDirection.Horizontal,
            HorizontalAlignment = Enum.HorizontalAlignment.Right,
            Padding = UDim.new(0, 10)
        }),
        Create("UIPadding", {
            PaddingRight = UDim.new(0, 15)
        })
    })

    local MinimizeBtn = Create("TextButton", {
        Name = "MinimizeBtn",
        Parent = ControlButtons,
        Size = UDim2.new(0, 28, 0, 28),
        BackgroundColor3 = NeoColors.Light,
        BackgroundTransparency = 0.5,
        Text = ""
    }, {
        Create("UICorner", {CornerRadius = UDim.new(0, 8)}),
        Create("UIStroke", {
            Color = NeoColors.Lighter,
            Thickness = 1,
            Transparency = 0.5
        }),
        Create("ImageLabel", {
            Size = UDim2.new(0, 16, 0, 16),
            Position = UDim2.new(0.5, -8, 0.5, -8),
            Image = Icons.Minimize,
            ImageColor3 = NeoColors.Text,
            BackgroundTransparency = 1
        })
    })

    local CloseBtn = Create("TextButton", {
        Name = "CloseBtn",
        Parent = ControlButtons,
        Size = UDim2.new(0, 28, 0, 28),
        BackgroundColor3 = NeoColors.Danger,
        BackgroundTransparency = 0.5,
        Text = ""
    }, {
        Create("UICorner", {CornerRadius = UDim.new(0, 8)}),
        Create("UIStroke", {
            Color = NeoColors.Danger,
            Thickness = 1,
            Transparency = 0.3
        }),
        Create("ImageLabel", {
            Size = UDim2.new(0, 16, 0, 16),
            Position = UDim2.new(0.5, -8, 0.5, -8),
            Image = Icons.X,
            ImageColor3 = NeoColors.Text,
            BackgroundTransparency = 1
        })
    })

    -- Main content area
    local ContentArea = Create("Frame", {
        Name = "ContentArea",
        Parent = MainContainer,
        Size = UDim2.new(1, 0, 1, -45),
        Position = UDim2.new(0, 0, 0, 45),
        BackgroundTransparency = 1
    })

    -- Sidebar for tabs
    local Sidebar = Create("Frame", {
        Name = "Sidebar",
        Parent = ContentArea,
        Size = UDim2.new(0, 180, 1, 0),
        BackgroundColor3 = NeoColors.Darker,
        BackgroundTransparency = 0.3
    }, {
        Create("UICorner", {
            CornerRadius = UDim.new(0, 20),
            CornerMask = Enum.CornerMask.BottomLeft
        }),
        Create("UIStroke", {
            Color = WindowConfig.AccentColor,
            Thickness = 1,
            Transparency = 0.3
        }),
        Create("UIPadding", {
            PaddingTop = UDim.new(0, 15),
            PaddingLeft = UDim.new(0, 10),
            PaddingRight = UDim.new(0, 10)
        }),
        Create("UIListLayout", {
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 8)
        })
    })

    -- User info panel in sidebar
    local UserPanel = Create("Frame", {
        Name = "UserPanel",
        Parent = Sidebar,
        Size = UDim2.new(1, 0, 0, 70),
        BackgroundColor3 = NeoColors.Light,
        BackgroundTransparency = 0.7
    }, {
        Create("UICorner", {CornerRadius = UDim.new(0, 12)}),
        Create("UIPadding", {
            PaddingTop = UDim.new(0, 10),
            PaddingBottom = UDim.new(0, 10),
            PaddingLeft = UDim.new(0, 10),
            PaddingRight = UDim.new(0, 10)
        }),
        Create("UIListLayout", {
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 8)
        })
    })

    Create("TextLabel", {
        Parent = UserPanel,
        Size = UDim2.new(1, 0, 0, 18),
        Text = LocalPlayer.DisplayName,
        TextColor3 = NeoColors.Text,
        TextSize = 16,
        Font = Enum.Font.GothamBold,
        TextXAlignment = Enum.TextXAlignment.Left,
        BackgroundTransparency = 1
    })

    if not WindowConfig.HidePremium then
        Create("TextLabel", {
            Parent = UserPanel,
            Size = UDim2.new(1, 0, 0, 14),
            Text = "@" .. LocalPlayer.Name,
            TextColor3 = NeoColors.TextDark,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            BackgroundTransparency = 1
        })
    end

    -- Tab container
    local TabContainer = Create("ScrollingFrame", {
        Name = "TabContainer",
        Parent = Sidebar,
        Size = UDim2.new(1, 0, 1, -90),
        Position = UDim2.new(0, 0, 0, 80),
        BackgroundTransparency = 1,
        ScrollBarThickness = 3,
        ScrollBarImageColor3 = WindowConfig.AccentColor,
        BorderSizePixel = 0,
        CanvasSize = UDim2.new(0, 0, 0, 0)
    }, {
        Create("UIListLayout", {
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 5)
        }),
        Create("UIPadding", {
            PaddingTop = UDim.new(0, 5),
            PaddingBottom = UDim.new(0, 5)
        })
    })

    -- Main tab content area
    local TabContentArea = Create("ScrollingFrame", {
        Name = "TabContentArea",
        Parent = ContentArea,
        Size = UDim2.new(1, -190, 1, -20),
        Position = UDim2.new(0, 190, 0, 10),
        BackgroundTransparency = 1,
        ScrollBarThickness = 4,
        ScrollBarImageColor3 = WindowConfig.AccentColor,
        BorderSizePixel = 0,
        CanvasSize = UDim2.new(0, 0, 0, 0)
    }, {
        Create("UIListLayout", {
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 15)
        }),
        Create("UIPadding", {
            PaddingTop = UDim.new(0, 15),
            PaddingBottom = UDim.new(0, 15),
            PaddingLeft = UDim.new(0, 15),
            PaddingRight = UDim.new(0, 15)
        })
    })

    -- Mobile reopen button (hidden by default)
    local MobileReopenButton = Create("TextButton", {
        Name = "MobileReopenButton",
        Parent = Orion,
        Size = UDim2.new(0, 50, 0, 50),
        Position = UDim2.new(0.5, -25, 0, 20),
        BackgroundColor3 = WindowConfig.AccentColor,
        BackgroundTransparency = 0.3,
        Text = "",
        Visible = false,
        ZIndex = 100
    }, {
        Create("UICorner", {CornerRadius = UDim.new(1, 0)}),
        Create("UIStroke", {
            Color = WindowConfig.AccentColor,
            Thickness = 2,
            Transparency = 0.5
        }),
        Create("ImageLabel", {
            Size = UDim2.new(0, 30, 0, 30),
            Position = UDim2.new(0.5, -15, 0.5, -15),
            Image = Icons.Menu,
            ImageColor3 = NeoColors.Text,
            BackgroundTransparency = 1
        })
    })

    -- Make draggable
    MakeDraggable(TitleBar, MainContainer)

    -- Connections
    AddConnection(MinimizeBtn.MouseButton1Click, function()
        Minimized = not Minimized
        if Minimized then
            TweenService:Create(MainContainer, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
                Size = UDim2.new(0, 300, 0, 45)
            }):Play()
            MinimizeBtn.ImageLabel.Image = Icons.Maximize
            ContentArea.Visible = false
        else
            TweenService:Create(MainContainer, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
                Size = WindowConfig.Size
            }):Play()
            MinimizeBtn.ImageLabel.Image = Icons.Minimize
            ContentArea.Visible = true
        end
    end)

    AddConnection(CloseBtn.MouseButton1Click, function()
        MainContainer.Visible = false
        MobileReopenButton.Visible = true
        UIHidden = true
        OrionLib:MakeNotification({
            Name = "Interface Hidden",
            Content = "Tap the button or press M to reopen",
            Color = NeoColors.Warning
        })
        if WindowConfig.CloseCallback then
            WindowConfig.CloseCallback()
        end
    end)

    AddConnection(MobileReopenButton.MouseButton1Click, function()
        MainContainer.Visible = true
        MobileReopenButton.Visible = false
        UIHidden = false
    end)

    AddConnection(UserInputService.InputBegan, function(Input)
        if Input.KeyCode == Enum.KeyCode.M then
            if UIHidden then
                MainContainer.Visible = true
                MobileReopenButton.Visible = false
                UIHidden = false
            else
                MainContainer.Visible = false
                MobileReopenButton.Visible = true
                UIHidden = true
            end
        end
    end)

    -- Make MobileReopenButton draggable
    MakeDraggable(MobileReopenButton, MobileReopenButton)

    -- Intro sequence
    if WindowConfig.IntroEnabled then
        spawn(function()
            MainContainer.Visible = false
            
            local IntroFrame = Create("Frame", {
                Parent = Orion,
                Size = UDim2.new(1, 0, 1, 0),
                BackgroundColor3 = NeoColors.Darker,
                BackgroundTransparency = 0.2,
                ZIndex = 999
            }, {
                Create("UICorner", {CornerRadius = UDim.new(0, 0)})
            })

            local IntroIcon = Create("ImageLabel", {
                Parent = IntroFrame,
                Size = UDim2.new(0, 0, 0, 0),
                Position = UDim2.new(0.5, 0, 0.4, 0),
                Image = WindowConfig.IntroIcon,
                ImageColor3 = WindowConfig.AccentColor,
                BackgroundTransparency = 1,
                AnchorPoint = Vector2.new(0.5, 0.5)
            })

            local IntroText = Create("TextLabel", {
                Parent = IntroFrame,
                Size = UDim2.new(1, 0, 0, 40),
                Position = UDim2.new(0, 0, 0.6, 0),
                Text = WindowConfig.IntroText,
                TextColor3 = NeoColors.Text,
                TextSize = 24,
                Font = Enum.Font.GothamBlack,
                BackgroundTransparency = 1,
                TextTransparency = 1
            })

            -- Animate intro
            TweenService:Create(IntroIcon, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                Size = UDim2.new(0, 80, 0, 80)
            }):Play()

            wait(0.8)
            
            TweenService:Create(IntroText, TweenInfo.new(0.5, Enum.EasingStyle.Quad), {
                TextTransparency = 0
            }):Play()

            wait(1.5)
            
            TweenService:Create(IntroFrame, TweenInfo.new(0.5, Enum.EasingStyle.Quad), {
                BackgroundTransparency = 1
            }):Play()
            
            TweenService:Create(IntroIcon, TweenInfo.new(0.5, Enum.EasingStyle.Quad), {
                ImageTransparency = 1
            }):Play()
            
            TweenService:Create(IntroText, TweenInfo.new(0.5, Enum.EasingStyle.Quad), {
                TextTransparency = 1
            }):Play()

            wait(0.5)
            IntroFrame:Destroy()
            MainContainer.Visible = true
        end)
    end

    -- Tab functions
    local TabFunction = {}
    function TabFunction:MakeTab(TabConfig)
        TabConfig = TabConfig or {}
        TabConfig.Name = TabConfig.Name or "New Tab"
        TabConfig.Icon = TabConfig.Icon or Icons.Home
        TabConfig.Color = TabConfig.Color or WindowConfig.AccentColor

        local TabButton = Create("TextButton", {
            Name = "TabButton_" .. TabConfig.Name,
            Parent = TabContainer,
            Size = UDim2.new(1, 0, 0, 40),
            BackgroundColor3 = NeoColors.Light,
            BackgroundTransparency = 0.8,
            Text = "",
            AutoButtonColor = false
        }, {
            Create("UICorner", {CornerRadius = UDim.new(0, 10)}),
            Create("UIStroke", {
                Color = TabConfig.Color,
                Thickness = 1,
                Transparency = 0.8
            }),
            Create("UIPadding", {
                PaddingLeft = UDim.new(0, 15),
                PaddingRight = UDim.new(0, 15)
            }),
            Create("UIListLayout", {
                SortOrder = Enum.SortOrder.LayoutOrder,
                FillDirection = Enum.FillDirection.Horizontal,
                Padding = UDim.new(0, 10)
            })
        })

        Create("ImageLabel", {
            Parent = TabButton,
            Size = UDim2.new(0, 20, 0, 20),
            Image = TabConfig.Icon,
            ImageColor3 = NeoColors.TextDark,
            BackgroundTransparency = 1
        })

        Create("TextLabel", {
            Parent = TabButton,
            Size = UDim2.new(1, -30, 1, 0),
            Text = TabConfig.Name,
            TextColor3 = NeoColors.TextDark,
            TextSize = 14,
            Font = Enum.Font.GothamSemibold,
            TextXAlignment = Enum.TextXAlignment.Left,
            BackgroundTransparency = 1
        })

        -- Tab content frame
        local TabContent = Create("Frame", {
            Name = "TabContent_" .. TabConfig.Name,
            Parent = TabContentArea,
            Size = UDim2.new(1, 0, 0, 0),
            BackgroundTransparency = 1,
            Visible = false,
            AutomaticSize = Enum.AutomaticSize.Y
        }, {
            Create("UIListLayout", {
                SortOrder = Enum.SortOrder.LayoutOrder,
                Padding = UDim.new(0, 15)
            })
        })

        -- Update TabContainer size
        AddConnection(TabContainer.UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"), function()
            TabContainer.CanvasSize = UDim2.new(0, 0, 0, TabContainer.UIListLayout.AbsoluteContentSize.Y)
        end)

        -- Update TabContentArea size
        AddConnection(TabContent.UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"), function()
            TabContentArea.CanvasSize = UDim2.new(0, 0, 0, TabContent.UIListLayout.AbsoluteContentSize.Y + 30)
        end)

        -- Set first tab as active
        if FirstTab then
            FirstTab = false
            TabButton.BackgroundTransparency = 0.6
            TabButton.UIStroke.Transparency = 0.3
            TabButton.ImageLabel.ImageColor3 = NeoColors.Text
            TabButton.TextLabel.TextColor3 = NeoColors.Text
            TabContent.Visible = true
        end

        -- Tab click handler
        AddConnection(TabButton.MouseButton1Click, function()
            -- Deactivate all tabs
            for _, Child in ipairs(TabContainer:GetChildren()) do
                if Child:IsA("TextButton") and Child.Name:find("TabButton_") then
                    TweenService:Create(Child, TweenInfo.new(0.2), {
                        BackgroundTransparency = 0.8
                    }):Play()
                    TweenService:Create(Child.UIStroke, TweenInfo.new(0.2), {
                        Transparency = 0.8
                    }):Play()
                    TweenService:Create(Child.ImageLabel, TweenInfo.new(0.2), {
                        ImageColor3 = NeoColors.TextDark
                    }):Play()
                    TweenService:Create(Child.TextLabel, TweenInfo.new(0.2), {
                        TextColor3 = NeoColors.TextDark
                    }):Play()
                end
            end
            
            -- Hide all tab contents
            for _, Child in ipairs(TabContentArea:GetChildren()) do
                if Child:IsA("Frame") and Child.Name:find("TabContent_") then
                    Child.Visible = false
                end
            end
            
            -- Activate clicked tab
            TweenService:Create(TabButton, TweenInfo.new(0.2), {
                BackgroundTransparency = 0.6
            }):Play()
            TweenService:Create(TabButton.UIStroke, TweenInfo.new(0.2), {
                Transparency = 0.3
            }):Play()
            TweenService:Create(TabButton.ImageLabel, TweenInfo.new(0.2), {
                ImageColor3 = NeoColors.Text
            }):Play()
            TweenService:Create(TabButton.TextLabel, TweenInfo.new(0.2), {
                TextColor3 = NeoColors.Text
            }):Play()
            
            TabContent.Visible = true
        end)

        -- Element creation functions for this tab
        local ElementFunction = {}
        
        function ElementFunction:AddSection(SectionConfig)
            SectionConfig = SectionConfig or {}
            SectionConfig.Name = SectionConfig.Name or "Section"
            SectionConfig.Color = SectionConfig.Color or WindowConfig.AccentColor

            local Section = Create("Frame", {
                Name = "Section",
                Parent = TabContent,
                Size = UDim2.new(1, 0, 0, 0),
                BackgroundTransparency = 1,
                AutomaticSize = Enum.AutomaticSize.Y
            }, {
                Create("UIListLayout", {
                    SortOrder = Enum.SortOrder.LayoutOrder,
                    Padding = UDim.new(0, 10)
                })
            })

            -- Section header
            local Header = Create("Frame", {
                Name = "Header",
                Parent = Section,
                Size = UDim2.new(1, 0, 0, 30),
                BackgroundTransparency = 1
            }, {
                Create("UIListLayout", {
                    SortOrder = Enum.SortOrder.LayoutOrder,
                    FillDirection = Enum.FillDirection.Horizontal,
                    Padding = UDim.new(0, 10)
                })
            })

            Create("Frame", {
                Name = "AccentLine",
                Parent = Header,
                Size = UDim2.new(0, 4, 1, 0),
                BackgroundColor3 = SectionConfig.Color,
                BackgroundTransparency = 0.3
            }, {
                Create("UICorner", {CornerRadius = UDim.new(0, 2)})
            })

            Create("TextLabel", {
                Name = "Title",
                Parent = Header,
                Size = UDim2.new(1, -20, 1, 0),
                Text = SectionConfig.Name,
                TextColor3 = NeoColors.Text,
                TextSize = 16,
                Font = Enum.Font.GothamBold,
                TextXAlignment = Enum.TextXAlignment.Left,
                BackgroundTransparency = 1
            })

            -- Section content container
            local Content = Create("Frame", {
                Name = "Content",
                Parent = Section,
                Size = UDim2.new(1, 0, 0, 0),
                BackgroundTransparency = 1,
                AutomaticSize = Enum.AutomaticSize.Y
            }, {
                Create("UIListLayout", {
                    SortOrder = Enum.SortOrder.LayoutOrder,
                    Padding = UDim.new(0, 10)
                }),
                Create("UIPadding", {
                    PaddingLeft = UDim.new(0, 14)
                })
            })

            local SectionElements = {}

            -- Button element
            function SectionElements:AddButton(ButtonConfig)
                ButtonConfig = ButtonConfig or {}
                ButtonConfig.Name = ButtonConfig.Name or "Button"
                ButtonConfig.Callback = ButtonConfig.Callback or function() end
                ButtonConfig.Color = ButtonConfig.Color or WindowConfig.AccentColor
                ButtonConfig.Icon = ButtonConfig.Icon or Icons.Zap

                local Button = {}

                local ButtonFrame = Create("TextButton", {
                    Name = "Button",
                    Parent = Content,
                    Size = UDim2.new(1, 0, 0, 40),
                    BackgroundColor3 = NeoColors.Light,
                    BackgroundTransparency = 0.7,
                    Text = "",
                    AutoButtonColor = false
                }, {
                    Create("UICorner", {CornerRadius = UDim.new(0, 10)}),
                    Create("UIStroke", {
                        Color = ButtonConfig.Color,
                        Thickness = 1,
                        Transparency = 0.5
                    }),
                    Create("UIPadding", {
                        PaddingLeft = UDim.new(0, 15),
                        PaddingRight = UDim.new(0, 15)
                    }),
                    Create("UIListLayout", {
                        SortOrder = Enum.SortOrder.LayoutOrder,
                        FillDirection = Enum.FillDirection.Horizontal,
                        Padding = UDim.new(0, 10)
                    })
                })

                if ButtonConfig.Icon then
                    Create("ImageLabel", {
                        Parent = ButtonFrame,
                        Size = UDim2.new(0, 20, 0, 20),
                        Image = ButtonConfig.Icon,
                        ImageColor3 = ButtonConfig.Color,
                        BackgroundTransparency = 1
                    })
                end

                Create("TextLabel", {
                    Parent = ButtonFrame,
                    Size = UDim2.new(1, ButtonConfig.Icon and -30 or 0, 1, 0),
                    Text = ButtonConfig.Name,
                    TextColor3 = NeoColors.Text,
                    TextSize = 14,
                    Font = Enum.Font.GothamSemibold,
                    TextXAlignment = ButtonConfig.Icon and Enum.TextXAlignment.Left or Enum.TextXAlignment.Center,
                    BackgroundTransparency = 1
                })

                -- Hover effects
                AddConnection(ButtonFrame.MouseEnter, function()
                    TweenService:Create(ButtonFrame, TweenInfo.new(0.2), {
                        BackgroundTransparency = 0.5
                    }):Play()
                    TweenService:Create(ButtonFrame.UIStroke, TweenInfo.new(0.2), {
                        Transparency = 0.3
                    }):Play()
                end)

                AddConnection(ButtonFrame.MouseLeave, function()
                    TweenService:Create(ButtonFrame, TweenInfo.new(0.2), {
                        BackgroundTransparency = 0.7
                    }):Play()
                    TweenService:Create(ButtonFrame.UIStroke, TweenInfo.new(0.2), {
                        Transparency = 0.5
                    }):Play()
                end)

                AddConnection(ButtonFrame.MouseButton1Click, function()
                    TweenService:Create(ButtonFrame, TweenInfo.new(0.1), {
                        BackgroundTransparency = 0.3
                    }):Play()
                    wait(0.1)
                    TweenService:Create(ButtonFrame, TweenInfo.new(0.1), {
                        BackgroundTransparency = 0.5
                    }):Play()
                    ButtonConfig.Callback()
                end)

                function Button:Set(NewText)
                    ButtonFrame.TextLabel.Text = NewText
                end

                return Button
            end

            -- Toggle element
            function SectionElements:AddToggle(ToggleConfig)
                ToggleConfig = ToggleConfig or {}
                ToggleConfig.Name = ToggleConfig.Name or "Toggle"
                ToggleConfig.Default = ToggleConfig.Default or false
                ToggleConfig.Callback = ToggleConfig.Callback or function() end
                ToggleConfig.Color = ToggleConfig.Color or WindowConfig.AccentColor
                ToggleConfig.Flag = ToggleConfig.Flag or nil
                ToggleConfig.Save = ToggleConfig.Save or false

                local Toggle = {Value = ToggleConfig.Default, Save = ToggleConfig.Save, Type = "Toggle"}

                local ToggleFrame = Create("TextButton", {
                    Name = "Toggle",
                    Parent = Content,
                    Size = UDim2.new(1, 0, 0, 40),
                    BackgroundColor3 = NeoColors.Light,
                    BackgroundTransparency = 0.7,
                    Text = "",
                    AutoButtonColor = false
                }, {
                    Create("UICorner", {CornerRadius = UDim.new(0, 10)}),
                    Create("UIStroke", {
                        Color = ToggleConfig.Color,
                        Thickness = 1,
                        Transparency = 0.5
                    }),
                    Create("UIPadding", {
                        PaddingLeft = UDim.new(0, 15),
                        PaddingRight = UDim.new(0, 15)
                    }),
                    Create("UIListLayout", {
                        SortOrder = Enum.SortOrder.LayoutOrder,
                        FillDirection = Enum.FillDirection.Horizontal
                    })
                })

                Create("TextLabel", {
                    Parent = ToggleFrame,
                    Size = UDim2.new(1, -50, 1, 0),
                    Text = ToggleConfig.Name,
                    TextColor3 = NeoColors.Text,
                    TextSize = 14,
                    Font = Enum.Font.GothamSemibold,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    BackgroundTransparency = 1
                })

                local ToggleSwitch = Create("Frame", {
                    Name = "ToggleSwitch",
                    Parent = ToggleFrame,
                    Size = UDim2.new(0, 40, 0, 20),
                    BackgroundColor3 = NeoColors.Dark,
                    BackgroundTransparency = 0.5
                }, {
                    Create("UICorner", {CornerRadius = UDim.new(1, 0)}),
                    Create("UIStroke", {
                        Color = ToggleConfig.Color,
                        Thickness = 2,
                        Transparency = 0.5
                    })
                })

                local ToggleCircle = Create("Frame", {
                    Name = "ToggleCircle",
                    Parent = ToggleSwitch,
                    Size = UDim2.new(0, 16, 0, 16),
                    Position = UDim2.new(0, 2, 0.5, -8),
                    BackgroundColor3 = NeoColors.Text,
                    BackgroundTransparency = 0
                }, {
                    Create("UICorner", {CornerRadius = UDim.new(1, 0)})
                })

                function Toggle:Set(Value)
                    self.Value = Value
                    if Value then
                        TweenService:Create(ToggleCircle, TweenInfo.new(0.2), {
                            Position = UDim2.new(1, -18, 0.5, -8),
                            BackgroundColor3 = ToggleConfig.Color
                        }):Play()
                        TweenService:Create(ToggleSwitch.UIStroke, TweenInfo.new(0.2), {
                            Transparency = 0.2
                        }):Play()
                    else
                        TweenService:Create(ToggleCircle, TweenInfo.new(0.2), {
                            Position = UDim2.new(0, 2, 0.5, -8),
                            BackgroundColor3 = NeoColors.Text
                        }):Play()
                        TweenService:Create(ToggleSwitch.UIStroke, TweenInfo.new(0.2), {
                            Transparency = 0.5
                        }):Play()
                    end
                    ToggleConfig.Callback(Value)
                end

                -- Hover effects
                AddConnection(ToggleFrame.MouseEnter, function()
                    TweenService:Create(ToggleFrame, TweenInfo.new(0.2), {
                        BackgroundTransparency = 0.5
                    }):Play()
                end)

                AddConnection(ToggleFrame.MouseLeave, function()
                    TweenService:Create(ToggleFrame, TweenInfo.new(0.2), {
                        BackgroundTransparency = 0.7
                    }):Play()
                end)

                AddConnection(ToggleFrame.MouseButton1Click, function()
                    Toggle:Set(not Toggle.Value)
                    if ToggleConfig.Save and OrionLib.SaveCfg then
                        SaveCfg(game.GameId)
                    end
                end)

                Toggle:Set(Toggle.Value)
                
                if ToggleConfig.Flag then
                    OrionLib.Flags[ToggleConfig.Flag] = Toggle
                end

                return Toggle
            end

            -- Slider element
            function SectionElements:AddSlider(SliderConfig)
                SliderConfig = SliderConfig or {}
                SliderConfig.Name = SliderConfig.Name or "Slider"
                SliderConfig.Min = SliderConfig.Min or 0
                SliderConfig.Max = SliderConfig.Max or 100
                SliderConfig.Default = SliderConfig.Default or 50
                SliderConfig.Callback = SliderConfig.Callback or function() end
                SliderConfig.Color = SliderConfig.Color or WindowConfig.AccentColor
                SliderConfig.Flag = SliderConfig.Flag or nil
                SliderConfig.Save = SliderConfig.Save or false

                local Slider = {Value = SliderConfig.Default, Save = SliderConfig.Save, Type = "Slider"}
                local Dragging = false

                local SliderFrame = Create("Frame", {
                    Name = "Slider",
                    Parent = Content,
                    Size = UDim2.new(1, 0, 0, 60),
                    BackgroundTransparency = 1
                }, {
                    Create("UIListLayout", {
                        SortOrder = Enum.SortOrder.LayoutOrder,
                        Padding = UDim.new(0, 5)
                    })
                })

                Create("TextLabel", {
                    Parent = SliderFrame,
                    Size = UDim2.new(1, 0, 0, 20),
                    Text = SliderConfig.Name,
                    TextColor3 = NeoColors.Text,
                    TextSize = 14,
                    Font = Enum.Font.GothamSemibold,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    BackgroundTransparency = 1
                })

                local SliderBar = Create("Frame", {
                    Name = "SliderBar",
                    Parent = SliderFrame,
                    Size = UDim2.new(1, 0, 0, 25),
                    BackgroundColor3 = NeoColors.Light,
                    BackgroundTransparency = 0.7
                }, {
                    Create("UICorner", {CornerRadius = UDim.new(1, 0)}),
                    Create("UIStroke", {
                        Color = SliderConfig.Color,
                        Thickness = 1,
                        Transparency = 0.5
                    })
                })

                local SliderFill = Create("Frame", {
                    Name = "SliderFill",
                    Parent = SliderBar,
                    Size = UDim2.new((SliderConfig.Default - SliderConfig.Min) / (SliderConfig.Max - SliderConfig.Min), 0, 1, 0),
                    BackgroundColor3 = SliderConfig.Color,
                    BackgroundTransparency = 0.3
                }, {
                    Create("UICorner", {CornerRadius = UDim.new(1, 0)})
                })

                local SliderHandle = Create("Frame", {
                    Name = "SliderHandle",
                    Parent = SliderFill,
                    Size = UDim2.new(0, 15, 0, 15),
                    Position = UDim2.new(1, -7.5, 0.5, -7.5),
                    BackgroundColor3 = NeoColors.Text,
                    AnchorPoint = Vector2.new(0.5, 0.5)
                }, {
                    Create("UICorner", {CornerRadius = UDim.new(1, 0)}),
                    Create("UIStroke", {
                        Color = SliderConfig.Color,
                        Thickness = 2,
                        Transparency = 0.3
                    })
                })

                local ValueLabel = Create("TextLabel", {
                    Parent = SliderFrame,
                    Size = UDim2.new(1, 0, 0, 15),
                    Text = tostring(SliderConfig.Default),
                    TextColor3 = NeoColors.TextDark,
                    TextSize = 12,
                    Font = Enum.Font.Gotham,
                    TextXAlignment = Enum.TextXAlignment.Right,
                    BackgroundTransparency = 1
                })

                function Slider:Set(Value)
                    self.Value = math.clamp(Value, SliderConfig.Min, SliderConfig.Max)
                    local Percent = (self.Value - SliderConfig.Min) / (SliderConfig.Max - SliderConfig.Min)
                    
                    TweenService:Create(SliderFill, TweenInfo.new(0.2), {
                        Size = UDim2.new(Percent, 0, 1, 0)
                    }):Play()
                    
                    ValueLabel.Text = tostring(self.Value)
                    SliderConfig.Callback(self.Value)
                end

                -- Dragging logic
                AddConnection(SliderBar.InputBegan, function(Input)
                    if Input.UserInputType == Enum.UserInputType.MouseButton1 or Input.UserInputType == Enum.UserInputType.Touch then
                        Dragging = true
                    end
                end)

                AddConnection(SliderBar.InputEnded, function(Input)
                    if Input.UserInputType == Enum.UserInputType.MouseButton1 or Input.UserInputType == Enum.UserInputType.Touch then
                        Dragging = false
                    end
                end)

                AddConnection(UserInputService.InputChanged, function(Input)
                    if Dragging and (Input.UserInputType == Enum.UserInputType.MouseMovement or Input.UserInputType == Enum.UserInputType.Touch) then
                        local MousePosition = Mouse.X
                        local BarAbsolutePosition = SliderBar.AbsolutePosition.X
                        local BarAbsoluteSize = SliderBar.AbsoluteSize.X
                        
                        local RelativePosition = math.clamp(MousePosition - BarAbsolutePosition, 0, BarAbsoluteSize)
                        local Percent = RelativePosition / BarAbsoluteSize
                        local Value = SliderConfig.Min + (Percent * (SliderConfig.Max - SliderConfig.Min))
                        
                        Slider:Set(Value)
                        
                        if SliderConfig.Save and OrionLib.SaveCfg then
                            SaveCfg(game.GameId)
                        end
                    end
                end)

                Slider:Set(Slider.Value)
                
                if SliderConfig.Flag then
                    OrionLib.Flags[SliderConfig.Flag] = Slider
                end

                return Slider
            end

            -- Label element
            function SectionElements:AddLabel(LabelConfig)
                LabelConfig = LabelConfig or {}
                LabelConfig.Text = LabelConfig.Text or "Label"
                LabelConfig.Color = LabelConfig.Color or NeoColors.Text

                local LabelFrame = Create("Frame", {
                    Name = "Label",
                    Parent = Content,
                    Size = UDim2.new(1, 0, 0, 30),
                    BackgroundColor3 = NeoColors.Light,
                    BackgroundTransparency = 0.8
                }, {
                    Create("UICorner", {CornerRadius = UDim.new(0, 8)}),
                    Create("UIStroke", {
                        Color = LabelConfig.Color,
                        Thickness = 1,
                        Transparency = 0.7
                    }),
                    Create("UIPadding", {
                        PaddingLeft = UDim.new(0, 15),
                        PaddingRight = UDim.new(0, 15)
                    })
                })

                local LabelText = Create("TextLabel", {
                    Parent = LabelFrame,
                    Size = UDim2.new(1, 0, 1, 0),
                    Text = LabelConfig.Text,
                    TextColor3 = NeoColors.Text,
                    TextSize = 14,
                    Font = Enum.Font.Gotham,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    BackgroundTransparency = 1
                })

                local LabelFunction = {}
                function LabelFunction:Set(NewText)
                    LabelText.Text = NewText
                end

                return LabelFunction
            end

            -- Dropdown element (simplified version)
            function SectionElements:AddDropdown(DropdownConfig)
                DropdownConfig = DropdownConfig or {}
                DropdownConfig.Name = DropdownConfig.Name or "Dropdown"
                DropdownConfig.Options = DropdownConfig.Options or {"Option 1", "Option 2", "Option 3"}
                DropdownConfig.Default = DropdownConfig.Default or DropdownConfig.Options[1]
                DropdownConfig.Callback = DropdownConfig.Callback or function() end
                DropdownConfig.Color = DropdownConfig.Color or WindowConfig.AccentColor
                DropdownConfig.Flag = DropdownConfig.Flag or nil
                DropdownConfig.Save = DropdownConfig.Save or false

                local Dropdown = {Value = DropdownConfig.Default, Options = DropdownConfig.Options, Type = "Dropdown", Save = DropdownConfig.Save}
                local DropdownOpen = false

                local DropdownFrame = Create("TextButton", {
                    Name = "Dropdown",
                    Parent = Content,
                    Size = UDim2.new(1, 0, 0, 40),
                    BackgroundColor3 = NeoColors.Light,
                    BackgroundTransparency = 0.7,
                    Text = "",
                    AutoButtonColor = false
                }, {
                    Create("UICorner", {CornerRadius = UDim.new(0, 10)}),
                    Create("UIStroke", {
                        Color = DropdownConfig.Color,
                        Thickness = 1,
                        Transparency = 0.5
                    }),
                    Create("UIPadding", {
                        PaddingLeft = UDim.new(0, 15),
                        PaddingRight = UDim.new(0, 15)
                    }),
                    Create("UIListLayout", {
                        SortOrder = Enum.SortOrder.LayoutOrder,
                        FillDirection = Enum.FillDirection.Horizontal
                    })
                })

                Create("TextLabel", {
                    Parent = DropdownFrame,
                    Size = UDim2.new(1, -40, 1, 0),
                    Text = DropdownConfig.Name,
                    TextColor3 = NeoColors.Text,
                    TextSize = 14,
                    Font = Enum.Font.GothamSemibold,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    BackgroundTransparency = 1
                })

                local SelectedLabel = Create("TextLabel", {
                    Parent = DropdownFrame,
                    Size = UDim2.new(0, 100, 1, 0),
                    Text = DropdownConfig.Default,
                    TextColor3 = NeoColors.TextDark,
                    TextSize = 12,
                    Font = Enum.Font.Gotham,
                    TextXAlignment = Enum.TextXAlignment.Right,
                    BackgroundTransparency = 1
                })

                Create("ImageLabel", {
                    Parent = DropdownFrame,
                    Size = UDim2.new(0, 20, 0, 20),
                    Image = Icons.ChevronDown,
                    ImageColor3 = NeoColors.TextDark,
                    BackgroundTransparency = 1
                })

                -- Dropdown options container
                local OptionsContainer = Create("Frame", {
                    Name = "OptionsContainer",
                    Parent = Content,
                    Size = UDim2.new(1, 0, 0, 0),
                    BackgroundColor3 = NeoColors.Darker,
                    BackgroundTransparency = 0.5,
                    Visible = false,
                    AutomaticSize = Enum.AutomaticSize.Y
                }, {
                    Create("UICorner", {CornerRadius = UDim.new(0, 8)}),
                    Create("UIStroke", {
                        Color = DropdownConfig.Color,
                        Thickness = 1,
                        Transparency = 0.5
                    }),
                    Create("UIListLayout", {
                        SortOrder = Enum.SortOrder.LayoutOrder,
                        Padding = UDim.new(0, 2)
                    }),
                    Create("UIPadding", {
                        PaddingTop = UDim.new(0, 8),
                        PaddingBottom = UDim.new(0, 8)
                    })
                })

                function Dropdown:Refresh(Options, Clear)
                    if Clear then
                        for _, Child in ipairs(OptionsContainer:GetChildren()) do
                            if Child:IsA("TextButton") then
                                Child:Destroy()
                            end
                        end
                    end
                    
                    self.Options = Options or self.Options
                    
                    for _, Option in ipairs(self.Options) do
                        local OptionButton = Create("TextButton", {
                            Parent = OptionsContainer,
                            Size = UDim2.new(1, -16, 0, 30),
                            BackgroundColor3 = NeoColors.Light,
                            BackgroundTransparency = 0.8,
                            Text = Option,
                            TextColor3 = NeoColors.Text,
                            TextSize = 12,
                            Font = Enum.Font.Gotham,
                            AutoButtonColor = false
                        }, {
                            Create("UICorner", {CornerRadius = UDim.new(0, 6)})
                        })

                        AddConnection(OptionButton.MouseButton1Click, function()
                            self.Value = Option
                            SelectedLabel.Text = Option
                            DropdownConfig.Callback(Option)
                            OptionsContainer.Visible = false
                            DropdownOpen = false
                            
                            if DropdownConfig.Save and OrionLib.SaveCfg then
                                SaveCfg(game.GameId)
                            end
                        end)

                        AddConnection(OptionButton.MouseEnter, function()
                            TweenService:Create(OptionButton, TweenInfo.new(0.2), {
                                BackgroundTransparency = 0.6
                            }):Play()
                        end)

                        AddConnection(OptionButton.MouseLeave, function()
                            TweenService:Create(OptionButton, TweenInfo.new(0.2), {
                                BackgroundTransparency = 0.8
                            }):Play()
                        end)
                    end
                end

                function Dropdown:Set(Value)
                    if table.find(self.Options, Value) then
                        self.Value = Value
                        SelectedLabel.Text = Value
                        DropdownConfig.Callback(Value)
                    end
                end

                -- Toggle dropdown
                AddConnection(DropdownFrame.MouseButton1Click, function()
                    DropdownOpen = not DropdownOpen
                    OptionsContainer.Visible = DropdownOpen
                    
                    if DropdownOpen then
                        OptionsContainer.Size = UDim2.new(1, 0, 0, 0)
                        OptionsContainer.AutomaticSize = Enum.AutomaticSize.Y
                        Dropdown:Refresh()
                    end
                end)

                -- Hover effects
                AddConnection(DropdownFrame.MouseEnter, function()
                    TweenService:Create(DropdownFrame, TweenInfo.new(0.2), {
                        BackgroundTransparency = 0.5
                    }):Play()
                end)

                AddConnection(DropdownFrame.MouseLeave, function()
                    TweenService:Create(DropdownFrame, TweenInfo.new(0.2), {
                        BackgroundTransparency = 0.7
                    }):Play()
                end)

                Dropdown:Set(Dropdown.Value)
                
                if DropdownConfig.Flag then
                    OrionLib.Flags[DropdownConfig.Flag] = Dropdown
                end

                return Dropdown
            end

            -- Add other elements similarly (Bind, Colorpicker, Textbox, etc.)
            -- For brevity, I'll include the most commonly used ones

            return SectionElements
        end

        return ElementFunction
    end

    return TabFunction
end

function OrionLib:Destroy()
    Orion:Destroy()
end

-- Configuration save/load functions
local function PackColor(Color)
    return {R = Color.R * 255, G = Color.G * 255, B = Color.B * 255}
end

local function UnpackColor(Color)
    return Color3.fromRGB(Color.R, Color.G, Color.B)
end

local function LoadCfg(Config)
    local Data = HttpService:JSONDecode(Config)
    for FlagName, Value in pairs(Data) do
        if OrionLib.Flags[FlagName] then
            spawn(function()
                if OrionLib.Flags[FlagName].Type == "Colorpicker" then
                    OrionLib.Flags[FlagName]:Set(UnpackColor(Value))
                else
                    OrionLib.Flags[FlagName]:Set(Value)
                end
            end)
        end
    end
end

local function SaveCfg(Name)
    if not OrionLib.SaveCfg then return end
    local Data = {}
    for FlagName, Flag in pairs(OrionLib.Flags) do
        if Flag.Save then
            if Flag.Type == "Colorpicker" then
                Data[FlagName] = PackColor(Flag.Value)
            else
                Data[FlagName] = Flag.Value
            end
        end
    end
    if writefile then
        writefile(OrionLib.Folder .. "/" .. Name .. ".json", HttpService:JSONEncode(Data))
    end
end

-- Return the library
return OrionLib
